[tox]
isolated_build = True
envlist = 
    py{39,310,311,312}-deps{latest,min}
    lint
    type

[testenv]
deps =
    pytest>=7.0.0
    pytest-cov>=4.0.0
    pytest-asyncio>=0.26.0
    httpx>=0.28.1
    langchain-core>=0.3.52
    langchain-community>=0.3.21
    langchain-postgres>=0.0.14
    psycopg2-binary>=2.9.10
    langchain-google-vertexai>=2.0.20
    depslatest: sqlalchemy
    depslatest: pydantic
    depslatest: sqlalchemy-utils
    depsmin: sqlalchemy==2.0.0
    depsmin: pydantic==2.0.0
    depsmin: sqlalchemy-utils==0.41.2

commands =
    python -m pytest {posargs:tests} --cov=docstate --cov-report=term-missing

[testenv:lint]
deps =
    black>=23.0.0
    isort>=5.0.0
    flake8>=6.0.0
skip_install = true
commands =
    black --check --diff docstate tests examples
    isort --check-only --diff docstate tests examples
    flake8 docstate tests examples

[testenv:type]
deps =
    mypy>=1.0.0
    sqlalchemy>=2.0.0
    pydantic>=2.0.0
    sqlalchemy-utils>=0.41.2
    types-requests
commands =
    mypy docstate tests examples

[flake8]
max-line-length = 88
extend-ignore = E203
exclude = .git,__pycache__,build,dist

[pytest]
testpaths = ["tests"]
asyncio_default_fixture_loop_scope = session
